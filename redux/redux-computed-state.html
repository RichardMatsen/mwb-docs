<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redux Selectors - Computed State | Migration Workbench Documentation</title>
    <meta name="description" content="Data migration workbench">
    
    
    <link rel="preload" href="/mwb-docs/assets/css/0.styles.0618f7b4.css" as="style"><link rel="preload" href="/mwb-docs/assets/js/app.48bb9d1d.js" as="script"><link rel="preload" href="/mwb-docs/assets/js/18.f3d20159.js" as="script"><link rel="prefetch" href="/mwb-docs/assets/js/9.42b6a76f.js"><link rel="prefetch" href="/mwb-docs/assets/js/2.d9b0988d.js"><link rel="prefetch" href="/mwb-docs/assets/js/3.07850e13.js"><link rel="prefetch" href="/mwb-docs/assets/js/4.ae8b6d84.js"><link rel="prefetch" href="/mwb-docs/assets/js/5.398e5acf.js"><link rel="prefetch" href="/mwb-docs/assets/js/6.861493c9.js"><link rel="prefetch" href="/mwb-docs/assets/js/7.f149b18a.js"><link rel="prefetch" href="/mwb-docs/assets/js/8.90deac09.js"><link rel="prefetch" href="/mwb-docs/assets/js/10.deb74c4a.js"><link rel="prefetch" href="/mwb-docs/assets/js/11.6b836bf2.js"><link rel="prefetch" href="/mwb-docs/assets/js/12.db73e4b5.js"><link rel="prefetch" href="/mwb-docs/assets/js/13.e9163d45.js"><link rel="prefetch" href="/mwb-docs/assets/js/14.916f61fc.js"><link rel="prefetch" href="/mwb-docs/assets/js/15.6ff1b8e5.js"><link rel="prefetch" href="/mwb-docs/assets/js/16.c23a2b6d.js"><link rel="prefetch" href="/mwb-docs/assets/js/17.b8542119.js"><link rel="prefetch" href="/mwb-docs/assets/js/19.472e3fa7.js"><link rel="prefetch" href="/mwb-docs/assets/js/20.6c0e11a3.js"><link rel="prefetch" href="/mwb-docs/assets/js/21.cbc624b0.js"><link rel="prefetch" href="/mwb-docs/assets/js/22.afee111e.js"><link rel="prefetch" href="/mwb-docs/assets/js/23.4c9743f8.js"><link rel="prefetch" href="/mwb-docs/assets/js/24.37197fbf.js"><link rel="prefetch" href="/mwb-docs/assets/js/25.ce770030.js"><link rel="prefetch" href="/mwb-docs/assets/js/26.ffef31d3.js"><link rel="prefetch" href="/mwb-docs/assets/js/27.37e21c81.js"><link rel="prefetch" href="/mwb-docs/assets/js/28.e8e19da0.js"><link rel="prefetch" href="/mwb-docs/assets/js/29.bc8c5494.js"><link rel="prefetch" href="/mwb-docs/assets/js/30.0074301c.js">
    <link rel="stylesheet" href="/mwb-docs/assets/css/0.styles.0618f7b4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/mwb-docs/" class="home-link router-link-active"><!----> <span class="site-name">Migration Workbench Documentation</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/mwb-docs/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/mwb-docs/measure-calculation/" class="nav-link">Measure Calculation</a></div><div class="nav-item"><a href="/mwb-docs/dashboard-thumbnail/" class="nav-link">DashboardThumbnail</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Redux Store</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-store.html" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-middleware.html" class="nav-link">Middleware</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-selector-helpers.html" class="nav-link">Selector Helpers</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-computed-state.html" class="nav-link router-link-exact-active router-link-active">Computed State</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-observable-arrays.html" class="nav-link">Observable Arrays</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-reducer-testing.html" class="nav-link">Reducer Testing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Testing</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mwb-docs/testing/cypress-e2e-tests.html" class="nav-link">Cypress e2e Testing</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/testing/code-coverage.html" class="nav-link">Unit Test Code Coverage</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/testing/npm-audit.html" class="nav-link">npm audit security report</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/RichardMatsen/mwb-v2-redux" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/mwb-docs/" class="nav-link">Overview</a></div><div class="nav-item"><a href="/mwb-docs/measure-calculation/" class="nav-link">Measure Calculation</a></div><div class="nav-item"><a href="/mwb-docs/dashboard-thumbnail/" class="nav-link">DashboardThumbnail</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Redux Store</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-store.html" class="nav-link">Overview</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-middleware.html" class="nav-link">Middleware</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-selector-helpers.html" class="nav-link">Selector Helpers</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-computed-state.html" class="nav-link router-link-exact-active router-link-active">Computed State</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-observable-arrays.html" class="nav-link">Observable Arrays</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/redux/redux-reducer-testing.html" class="nav-link">Reducer Testing</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Testing</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mwb-docs/testing/cypress-e2e-tests.html" class="nav-link">Cypress e2e Testing</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/testing/code-coverage.html" class="nav-link">Unit Test Code Coverage</a></li><li class="dropdown-item"><!----> <a href="/mwb-docs/testing/npm-audit.html" class="nav-link">npm audit security report</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/RichardMatsen/mwb-v2-redux" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Redux Selectors - Computed State</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/mwb-docs/redux/redux-computed-state.html#computed-class" class="sidebar-link">Computed class</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/mwb-docs/redux/redux-computed-state.html#usage" class="sidebar-link">Usage</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="redux-selectors-computed-state"><a href="#redux-selectors-computed-state" aria-hidden="true" class="header-anchor">#</a> Redux Selectors - Computed State</h1> <p>Computed state properties are functions on stored state which provide alternate, filtered, or aggregate views.  They are useful because they allow the amount of data stored in state to be kept to a minimum.</p> <p>The redux library <code>angular-redux/store</code> does not explicitly implement computed state in the same way as other libraries, but achieves it via <code>@select()</code> and <code>@select$()</code> decorators (ref: <a href="https://github.com/angular-redux/store/blob/master/articles/select-pattern.md" target="_blank" rel="noopener noreferrer">The Select Pattern<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>).</p> <p>The problem is, the code for these selectors is not centralized. Examples given in docs show each component or service implementing the computation code. However, it would be preferable to defined the logic once on the store.</p> <p>For example, the <code>visibleFiles</code> property is used on both the <strong>page component</strong> and the <strong>search component</strong>, so it would be useful to define the calculation in one place.</p> <p>This can be done by creating a <code>Computed</code> class and injecting it into components and services as needed. Note that some <em>'properties'</em> are implemented as methods since we need to pass in the <code>page</code> parameter. The result is a higher-order function similar to the pattern for Middleware.</p> <p>This is possible, since a <em><strong>Selector</strong></em> can be a function - from the <a href="https://github.com/angular-redux/store/blob/master/src/components/selectors.ts" target="_blank" rel="noopener noreferrer">source<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> type FunctionSelector<span class="token operator">&lt;</span>RootState<span class="token punctuation">,</span> <span class="token constant">S</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s<span class="token punctuation">:</span> RootState<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token constant">S</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> type Selector<span class="token operator">&lt;</span>RootState<span class="token punctuation">,</span> <span class="token constant">S</span><span class="token operator">&gt;</span> <span class="token operator">=</span>
  <span class="token operator">|</span> PropertySelector
  <span class="token operator">|</span> PathSelector
  <span class="token operator">|</span> FunctionSelector<span class="token operator">&lt;</span>RootState<span class="token punctuation">,</span> <span class="token constant">S</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="computed-class"><a href="#computed-class" aria-hidden="true" class="header-anchor">#</a> Computed class</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code>@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Computed</span> <span class="token punctuation">{</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> ngRedux<span class="token punctuation">:</span> NgRedux<span class="token operator">&lt;</span>IAppState<span class="token operator">&gt;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">visibleFiles$</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span>IFileInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ngRedux<span class="token punctuation">.</span>select<span class="token operator">&lt;</span>IFileInfo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">visibleFiles</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">private</span> <span class="token function-variable function">visibleFiles</span> <span class="token operator">=</span> <span class="token punctuation">(</span>page<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>state<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> files <span class="token operator">=</span> state<span class="token punctuation">.</span>pages<span class="token punctuation">[</span>page<span class="token punctuation">]</span><span class="token punctuation">.</span>files <span class="token operator">||</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> numVisible <span class="token operator">=</span> state<span class="token punctuation">.</span>pages<span class="token punctuation">[</span>page<span class="token punctuation">]</span><span class="token punctuation">.</span>numVisible <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> files<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> numVisible<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="usage"><a href="#usage" aria-hidden="true" class="header-anchor">#</a> Usage</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token keyword">private</span> <span class="token function">getResults</span><span class="token punctuation">(</span>searchTerm<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>computed<span class="token punctuation">.</span><span class="token function">visibleFiles$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>page<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">take</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>files <span class="token operator">=&gt;</span> <span class="token operator">...</span>
  <span class="token punctuation">}</span>
</code></pre></div><hr></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">9/3/2018, 8:47:06 PM</span></div></div> <!----> </div> <!----></div></div>
    <script src="/mwb-docs/assets/js/18.f3d20159.js" defer></script><script src="/mwb-docs/assets/js/app.48bb9d1d.js" defer></script>
  </body>
</html>
